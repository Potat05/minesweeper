var De=Object.defineProperty;var Oe=(t,e,n)=>e in t?De(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var T=(t,e,n)=>(Oe(t,typeof e!="symbol"?e+"":e,n),n);import{s as se,n as W,b as le,f as ae,o as Le,h as Fe,r as We}from"./scheduler.0298b666.js";import{S as we,i as Me,e as R,a as U,f as p,A as Ee,B,C as I,j as w,k as d,D as v,z as M,E as oe,s as Z,g as H,r as fe,x as Ne,c as $,h as P,u as ue,l as x,v as he,F as ee,d as de,t as ce,w as pe,m as re,n as ie}from"./index.1d5e33a4.js";function te(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function me(t,e,n){const a=t.slice();return a[5]=e[n],a}function ge(t){let e,n,a,r,s,l,f,c,O,g,y;return{c(){e=B("svg"),n=B("defs"),a=B("pattern"),r=B("line"),s=B("path"),l=B("path"),f=B("path"),c=B("path"),O=B("path"),g=B("path"),y=B("path"),this.h()},l(_){e=I(_,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,class:!0});var m=w(e);n=I(m,"defs",{});var N=w(n);a=I(N,"pattern",{id:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var S=w(a);r=I(S,"line",{stroke:!0,"stroke-width":!0,y2:!0}),w(r).forEach(p),S.forEach(p),N.forEach(p),s=I(m,"path",{d:!0,class:!0}),w(s).forEach(p),l=I(m,"path",{d:!0,class:!0}),w(l).forEach(p),f=I(m,"path",{d:!0,class:!0}),w(f).forEach(p),c=I(m,"path",{d:!0,class:!0}),w(c).forEach(p),O=I(m,"path",{d:!0,class:!0}),w(O).forEach(p),g=I(m,"path",{d:!0,class:!0}),w(g).forEach(p),y=I(m,"path",{d:!0,class:!0}),w(y).forEach(p),m.forEach(p),this.h()},h(){d(r,"stroke","#800"),d(r,"stroke-width","1px"),d(r,"y2","1"),d(a,"id","off-fill"),d(a,"width","1"),d(a,"height","1"),d(a,"patternUnits","userSpaceOnUse"),d(a,"patternTransform","rotate(10)"),d(s,"d","M1 1l1-1h6l1 1-1 1H2z"),d(s,"class","svelte-n5l988"),v(s,"on",t[1][t[5]][0]),d(l,"d","M9 1l1 1v6L9 9 8 8V2z"),d(l,"class","svelte-n5l988"),v(l,"on",t[1][t[5]][1]),d(f,"d","M9 9l1 1v6l-1 1-1-1v-6z"),d(f,"class","svelte-n5l988"),v(f,"on",t[1][t[5]][2]),d(c,"d","M9 17l-1 1H2l-1-1 1-1h6z"),d(c,"class","svelte-n5l988"),v(c,"on",t[1][t[5]][3]),d(O,"d","M1 17l-1-1v-6l1-1 1 1v6z"),d(O,"class","svelte-n5l988"),v(O,"on",t[1][t[5]][4]),d(g,"d","M1 9L0 8V2l1-1 1 1v6z"),d(g,"class","svelte-n5l988"),v(g,"on",t[1][t[5]][5]),d(y,"d","M1 9l1-1h6l1 1-1 1H2z"),d(y,"class","svelte-n5l988"),v(y,"on",t[1][t[5]][6]),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","192"),d(e,"height","320"),d(e,"viewBox","-1 -1 12 20"),d(e,"class","segment svelte-n5l988")},m(_,m){U(_,e,m),M(e,n),M(n,a),M(a,r),M(e,s),M(e,l),M(e,f),M(e,c),M(e,O),M(e,g),M(e,y)},p(_,m){m&3&&v(s,"on",_[1][_[5]][0]),m&3&&v(l,"on",_[1][_[5]][1]),m&3&&v(f,"on",_[1][_[5]][2]),m&3&&v(c,"on",_[1][_[5]][3]),m&3&&v(O,"on",_[1][_[5]][4]),m&3&&v(g,"on",_[1][_[5]][5]),m&3&&v(y,"on",_[1][_[5]][6])},d(_){_&&p(e)}}}function Se(t){let e,n=te(t[0]),a=[];for(let r=0;r<n.length;r+=1)a[r]=ge(me(t,n,r));return{c(){for(let r=0;r<a.length;r+=1)a[r].c();e=R()},l(r){for(let s=0;s<a.length;s+=1)a[s].l(r);e=R()},m(r,s){for(let l=0;l<a.length;l+=1)a[l]&&a[l].m(r,s);U(r,e,s)},p(r,[s]){if(s&3){n=te(r[0]);let l;for(l=0;l<n.length;l+=1){const f=me(r,n,l);a[l]?a[l].p(f,s):(a[l]=ge(f),a[l].c(),a[l].m(e.parentNode,e))}for(;l<a.length;l+=1)a[l].d(1);a.length=n.length}},i:W,o:W,d(r){r&&p(e),Ee(a,r)}}}function Be(t,e,n){let a,{minDigits:r=3}=e,{maxDigits:s=3}=e,{number:l}=e;const f={0:[!0,!0,!0,!0,!0,!0,!1],1:[!1,!0,!0,!1,!1,!1,!1],2:[!0,!0,!1,!0,!0,!1,!0],3:[!0,!0,!0,!0,!1,!1,!0],4:[!1,!0,!0,!1,!1,!0,!0],5:[!0,!1,!0,!0,!1,!0,!0],6:[!0,!1,!0,!0,!0,!0,!0],7:[!0,!0,!0,!1,!1,!1,!1],8:[!0,!0,!0,!0,!0,!0,!0],9:[!0,!0,!0,!0,!1,!0,!0],"-":[!1,!1,!1,!1,!1,!1,!0]," ":[!1,!1,!1,!1,!1,!1,!1]};return t.$$set=c=>{"minDigits"in c&&n(2,r=c.minDigits),"maxDigits"in c&&n(3,s=c.maxDigits),"number"in c&&n(4,l=c.number)},t.$$.update=()=>{t.$$.dirty&28&&n(0,a=Math.floor(l).toString().padStart(r," ").slice(-s).split(""))},[a,f,r,s,l]}class _e extends we{constructor(e){super(),Me(this,e,Be,Se,se,{minDigits:2,maxDigits:3,number:4})}}let ve=0;class Ie{constructor(){T(this,"destroyed",!1);T(this,"listeners",new Map)}addEventListener(e,n,a=!1){var r;if(this.destroyed)throw new Error("Usage of event dispatcher after being destroyed.");return this.listeners.has(e)||this.listeners.set(e,[]),(r=this.listeners.get(e))==null||r.push({callbackfn:n,once:a,id:ve}),ve++}removeEventListener(){if(this.destroyed)throw new Error("Usage of event dispatcher after being destroyed.");if(typeof arguments[0]=="number"){for(const e of this.listeners.values())for(let n=0;n<e.length;n++)if(e[n].id==arguments[0])return e.splice(n,1),!0;return!1}else{const e=arguments[0],n=arguments[1],a=arguments[2],r=this.listeners.get(e);if(r===void 0)return!1;for(let s=0;s<r.length;s++){const l=r[s];if(l.callbackfn===n&&l.once===a)return r.splice(s,1),!0}return!1}}dispatchEvent(e,...n){if(this.destroyed)throw new Error("Usage of event dispatcher after being destroyed.");const a=this.listeners.get(e);a!==void 0&&a.forEach(r=>{r.callbackfn(...n),r.once&&this.removeEventListener(e,r.callbackfn,r.once)})}destroyDispatcher(){if(this.destroyed)throw new Error("Usage of event dispatcher after being destroyed.");this.destroyed=!0,this.listeners.forEach((e,n)=>{this.listeners.delete(n)})}}class Ue extends Ie{constructor(n){super();T(this,"interval");T(this,"_running",!1);T(this,"_startDate",-1);T(this,"timeout",-1);T(this,"expected",-1);this.interval=n}get running(){return this._running}get startDate(){return this._startDate}step(){const n=Date.now(),a=n-this.expected,r=n-this._startDate;a>this.interval&&this.dispatchEvent("error",r,a),this.dispatchEvent("tick",r),this.expected+=this.interval,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.step(),Math.max(0,this.interval-a))}start(){this._running||(this._running=!0,this._startDate=Date.now(),this.expected=this._startDate+this.interval,this.timeout=setTimeout(()=>this.step(),this.interval))}stop(){this._running&&(this._running=!1,this._startDate=-1,clearTimeout(this.timeout))}}function ye(t,e,n){const a=t.slice();return a[29]=e[n],a[30]=e,a[31]=n,a}function Ve(t){return{c(){this.h()},l(e){this.h()},h(){document.title="Minesweeper - Lost"},m:W,d:W}}function ze(t){return document.title="Minesweeper - Victory - ⏱ "+Math.floor(t[5]/60).toString().padStart(2,"0")+":"+(t[5]%60).toString().padStart(2,"0"),{c:W,l:W,m:W,d:W}}function Ce(t){return document.title="Minesweeper - ⏱ "+Math.floor(t[5]/60).toString().padStart(2,"0")+":"+(t[5]%60).toString().padStart(2,"0")+" - 🚩 "+t[3],{c:W,l:W,m:W,d:W}}function Ae(t){return{c(){this.h()},l(e){this.h()},h(){document.title="Minesweeper"},m:W,d:W}}function be(t){let e;function n(s,l){if(s[2]==s[6].Waiting)return Ae;if(s[2]==s[6].Generated)return Ce;if(s[2]==s[6].Won)return ze;if(s[2]==s[6].Lost)return Ve}let a=n(t),r=a&&a(t);return{c(){r&&r.c(),e=R()},l(s){r&&r.l(s),e=R()},m(s,l){r&&r.m(s,l),U(s,e,l)},p(s,l){a!==(a=n(s))&&(r&&r.d(1),r=a&&a(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){s&&p(e),r&&r.d(s)}}}function Te(t){let e;return{c(){e=re("😵")},l(n){e=ie(n,"😵")},m(n,a){U(n,e,a)},d(n){n&&p(e)}}}function He(t){let e;return{c(){e=re("😎")},l(n){e=ie(n,"😎")},m(n,a){U(n,e,a)},d(n){n&&p(e)}}}function Pe(t){let e;return{c(){e=re("😊")},l(n){e=ie(n,"😊")},m(n,a){U(n,e,a)},d(n){n&&p(e)}}}function Re(t){let e,n,a,r;return{c(){e=H("div"),this.h()},l(s){e=P(s,"DIV",{class:!0}),w(e).forEach(p),this.h()},h(){d(e,"class",n="tile"+(t[29].type==t[7].Open?` mines-nearby-${t[9](t[29].x,t[29].y)}`:"")+" svelte-1ao09xa"),v(e,"opened",t[29].type==t[7].Open),v(e,"flagged",t[29].type==t[7].Flagged),v(e,"exploded",t[29].isMine&&t[29].type==t[7].Open),v(e,"displayMine",t[2]==t[6].Lost&&t[29].isMine)},m(s,l){U(s,e,l),a||(r=ee(e,"contextmenu",t[20]),a=!0)},p(s,l){l[0]&16&&n!==(n="tile"+(s[29].type==s[7].Open?` mines-nearby-${s[9](s[29].x,s[29].y)}`:"")+" svelte-1ao09xa")&&d(e,"class",n),l[0]&144&&v(e,"opened",s[29].type==s[7].Open),l[0]&144&&v(e,"flagged",s[29].type==s[7].Flagged),l[0]&144&&v(e,"exploded",s[29].isMine&&s[29].type==s[7].Open),l[0]&84&&v(e,"displayMine",s[2]==s[6].Lost&&s[29].isMine)},d(s){s&&p(e),a=!1,r()}}}function je(t){let e,n,a,r;function s(...f){return t[18](t[29],t[30],t[31],...f)}function l(...f){return t[19](t[29],t[30],t[31],...f)}return{c(){e=H("button"),this.h()},l(f){e=P(f,"BUTTON",{class:!0}),w(e).forEach(p),this.h()},h(){d(e,"class",n="tile"+(t[29].type==t[7].Open?` mines-nearby-${t[9](t[29].x,t[29].y)}`:"")+" svelte-1ao09xa"),v(e,"opened",t[29].type==t[7].Open),v(e,"flagged",t[29].type==t[7].Flagged),v(e,"exploded",t[29].isMine&&t[29].type==t[7].Open)},m(f,c){U(f,e,c),a||(r=[ee(e,"click",s),ee(e,"contextmenu",l)],a=!0)},p(f,c){t=f,c[0]&16&&n!==(n="tile"+(t[29].type==t[7].Open?` mines-nearby-${t[9](t[29].x,t[29].y)}`:"")+" svelte-1ao09xa")&&d(e,"class",n),c[0]&144&&v(e,"opened",t[29].type==t[7].Open),c[0]&144&&v(e,"flagged",t[29].type==t[7].Flagged),c[0]&144&&v(e,"exploded",t[29].isMine&&t[29].type==t[7].Open)},d(f){f&&p(e),a=!1,We(r)}}}function ke(t){let e,n;function a(l,f){return f[0]&20&&(e=null),e==null&&(e=!!(l[2]==l[6].Waiting||l[2]==l[6].Generated&&(l[29].type!=l[7].Open||l[11](l[29].x,l[29].y)&&l[9](l[29].x,l[29].y)==l[10](l[29].x,l[29].y)))),e?je:Re}let r=a(t,[-1,-1]),s=r(t);return{c(){s.c(),n=R()},l(l){s.l(l),n=R()},m(l,f){s.m(l,f),U(l,n,f)},p(l,f){r===(r=a(l,f))&&s?s.p(l,f):(s.d(1),s=r(l),s&&(s.c(),s.m(n.parentNode,n)))},d(l){l&&p(n),s.d(l)}}}function qe(t){let e=t[5],n,a,r,s,l,f,c,O,g,y,_,m,N,S,L,V,K,J,F=be(t);function Q(u){t[16](u)}let z={minDigits:3,maxDigits:1/0};t[3]!==void 0&&(z.number=t[3]),f=new _e({props:z}),le.push(()=>oe(f,"number",Q));function q(u,D){if(u[2]==u[6].Waiting||u[2]==u[6].Generated)return Pe;if(u[2]==u[6].Won)return He;if(u[2]==u[6].Lost)return Te}let C=q(t),b=C&&C(t);function X(u){t[17](u)}let Y={minDigits:3,maxDigits:1/0};t[5]!==void 0&&(Y.number=t[5]),m=new _e({props:Y}),le.push(()=>oe(m,"number",X));let A=te(t[4]),k=[];for(let u=0;u<A.length;u+=1)k[u]=ke(ye(t,A,u));return{c(){F.c(),n=R(),a=Z(),r=H("div"),s=H("div"),l=H("div"),fe(f.$$.fragment),O=Z(),g=H("button"),b&&b.c(),y=Z(),_=H("div"),fe(m.$$.fragment),S=Z(),L=H("div");for(let u=0;u<k.length;u+=1)k[u].c();this.h()},l(u){const D=Ne("svelte-1fu1i1v",document.head);F.l(D),n=R(),D.forEach(p),a=$(u),r=P(u,"DIV",{class:!0});var i=w(r);s=P(i,"DIV",{class:!0});var o=w(s);l=P(o,"DIV",{class:!0});var h=w(l);ue(f.$$.fragment,h),h.forEach(p),O=$(o),g=P(o,"BUTTON",{class:!0});var E=w(g);b&&b.l(E),E.forEach(p),y=$(o),_=P(o,"DIV",{class:!0});var j=w(_);ue(m.$$.fragment,j),j.forEach(p),o.forEach(p),S=$(i),L=P(i,"DIV",{class:!0,style:!0});var G=w(L);for(let ne=0;ne<k.length;ne+=1)k[ne].l(G);G.forEach(p),i.forEach(p),this.h()},h(){d(l,"class","display svelte-1ao09xa"),d(g,"class","button svelte-1ao09xa"),d(_,"class","display svelte-1ao09xa"),d(s,"class","toparea svelte-1ao09xa"),d(L,"class","board svelte-1ao09xa"),x(L,"grid-template-columns","repeat("+t[0]+", 1fr)"),x(L,"grid-template-rows","repeat("+t[1]+", 1fr)"),d(r,"class","game svelte-1ao09xa")},m(u,D){F.m(document.head,null),M(document.head,n),U(u,a,D),U(u,r,D),M(r,s),M(s,l),he(f,l,null),M(s,O),M(s,g),b&&b.m(g,null),M(s,y),M(s,_),he(m,_,null),M(r,S),M(r,L);for(let i=0;i<k.length;i+=1)k[i]&&k[i].m(L,null);V=!0,K||(J=ee(g,"click",t[14]),K=!0)},p(u,D){D[0]&32&&se(e,e=u[5])?(F.d(1),F=be(u),F.c(),F.m(n.parentNode,n)):F.p(u,D);const i={};!c&&D[0]&8&&(c=!0,i.number=u[3],ae(()=>c=!1)),f.$set(i),C!==(C=q(u))&&(b&&b.d(1),b=C&&C(u),b&&(b.c(),b.m(g,null)));const o={};if(!N&&D[0]&32&&(N=!0,o.number=u[5],ae(()=>N=!1)),m.$set(o),D[0]&16340){A=te(u[4]);let h;for(h=0;h<A.length;h+=1){const E=ye(u,A,h);k[h]?k[h].p(E,D):(k[h]=ke(E),k[h].c(),k[h].m(L,null))}for(;h<k.length;h+=1)k[h].d(1);k.length=A.length}(!V||D[0]&1)&&x(L,"grid-template-columns","repeat("+u[0]+", 1fr)"),(!V||D[0]&2)&&x(L,"grid-template-rows","repeat("+u[1]+", 1fr)")},i(u){V||(de(f.$$.fragment,u),de(m.$$.fragment,u),V=!0)},o(u){ce(f.$$.fragment,u),ce(m.$$.fragment,u),V=!1},d(u){u&&(p(a),p(r)),p(n),F.d(u),pe(f),b&&b.d(),pe(m),Ee(k,u),K=!1,J()}}}function Ge(t,e,n){var a=(i=>(i[i.Waiting=0]="Waiting",i[i.Generated=1]="Generated",i[i.Won=2]="Won",i[i.Lost=3]="Lost",i))(a||{});let r=0,{width:s}=e,{height:l}=e,{numMines:f}=e,c=0;var O=(i=>(i[i.Covered=0]="Covered",i[i.Open=1]="Open",i[i.Flagged=2]="Flagged",i))(O||{});let g=[];function y(i,o){return i<0||i>=s||o<0||o>=l?{x:i,y:o,isMine:!1,type:1}:g[i+o*s]}function _(){n(4,g=new Array(s*l));for(let i=0;i<s;i++)for(let o=0;o<l;o++)n(4,g[i+o*s]={x:i,y:o,isMine:!1,type:0},g)}const m=[{x:0,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1},{x:-1,y:0}];function*N(i,o){for(const h of m)yield y(i+h.x,o+h.y)}function S(i,o){let h=0;for(const E of N(i,o))E.isMine&&h++;return h}function L(i,o){let h=0;for(const E of N(i,o))E.type==2&&h++;return h}function V(i,o){for(const h of N(i,o))if(h.type==0)return!0;return!1}function K(i,o){if(g.length-9<=f)throw new Error("Too many mines for board, cannot generate board.");do{_();const h=[...g];for(let E=0;E<f;E++){const j=Math.floor(Math.random()*h.length),G=h.splice(j,1)[0];G.isMine=!0}}while(S(i,o)>0);n(2,r=1),C()}function J(){if(r!=1)return;g.reduce((o,h)=>h.isMine&&h.type==2?++o:o,0)==f&&c==0&&g.every(o=>o.type==2||o.type==1)&&(n(2,r=2),b())}function F(i,o){if(r==0&&K(i,o),r==1&&y(i,o).type!=2){if(y(i,o).type==0){if(y(i,o).type=1,y(i,o).isMine){n(2,r=3),b();return}if(S(i,o)==0)for(const h of N(i,o))F(h.x,h.y)}else if(y(i,o).type==1&&S(i,o)==L(i,o))for(const h of N(i,o))y(h.x,h.y).type==0&&F(h.x,h.y);J()}}function Q(i,o){if(r!=1)return;const h=y(i,o);if(h.type==1)return;h.type=h.type==0?2:0;const E=g.reduce((j,G)=>G.type==2?++j:j,0);n(3,c=f-E),J()}let z=0,q=new Ue(1e3);q.addEventListener("tick",i=>{n(5,z=Math.floor(i/1e3))});function C(){q.start()}function b(){q.stop()}function X(){n(2,r=0),_(),n(3,c=f),b(),n(5,z=0)}Le(()=>{X()}),Fe(()=>{b()});function Y(i){c=i,n(3,c)}function A(i){z=i,n(5,z)}const k=(i,o,h,E)=>{r!=a.Waiting&&r!=a.Generated||(E.preventDefault(),F(i.x,i.y),n(4,o[h]=y(i.x,i.y),g))},u=(i,o,h,E)=>{r==a.Generated&&(E.preventDefault(),Q(i.x,i.y),n(4,o[h]=y(i.x,i.y),g))},D=i=>{r==a.Generated&&i.preventDefault()};return t.$$set=i=>{"width"in i&&n(0,s=i.width),"height"in i&&n(1,l=i.height),"numMines"in i&&n(15,f=i.numMines)},[s,l,r,c,g,z,a,O,y,S,L,V,F,Q,X,f,Y,A,k,u,D]}class Xe extends we{constructor(e){super(),Me(this,e,Ge,qe,se,{width:0,height:1,numMines:15},null,[-1,-1])}}export{Xe as B};
